<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: AttentionLayer Pages: 1 -->
<svg width="1689pt" height="183pt"
 viewBox="0.00 0.00 1689.00 183.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 179)">
<title>AttentionLayer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-179 1685,-179 1685,4 -4,4"/>
<!-- hidden_state -->
<g id="node1" class="node">
<title>hidden_state</title>
<polygon fill="#f0f0f0" stroke="black" points="135,-119 0,-119 0,-81 135,-81 135,-119"/>
<text text-anchor="middle" x="67.5" y="-103.8" font-family="Times,serif" font-size="14.00">Hidden State (h)</text>
<text text-anchor="middle" x="67.5" y="-88.8" font-family="Times,serif" font-size="14.00">BxSx4096</text>
</g>
<!-- q_proj -->
<g id="node2" class="node">
<title>q_proj</title>
<polygon fill="#f0f0f0" stroke="black" points="347,-175 171,-175 171,-137 347,-137 347,-175"/>
<text text-anchor="middle" x="259" y="-159.8" font-family="Times,serif" font-size="14.00">Query Projection (Wq)</text>
<text text-anchor="middle" x="259" y="-144.8" font-family="Times,serif" font-size="14.00">4096x4096</text>
</g>
<!-- hidden_state&#45;&gt;q_proj -->
<g id="edge1" class="edge">
<title>hidden_state&#45;&gt;q_proj</title>
<path fill="none" stroke="black" d="M132.92,-119.04C149.24,-123.86 166.91,-129.08 183.68,-134.04"/>
<polygon fill="black" stroke="black" points="182.85,-137.44 193.44,-136.92 184.84,-130.73 182.85,-137.44"/>
</g>
<!-- k_proj -->
<g id="node3" class="node">
<title>k_proj</title>
<polygon fill="#f0f0f0" stroke="black" points="338,-119 180,-119 180,-81 338,-81 338,-119"/>
<text text-anchor="middle" x="259" y="-103.8" font-family="Times,serif" font-size="14.00">Key Projection (Wk)</text>
<text text-anchor="middle" x="259" y="-88.8" font-family="Times,serif" font-size="14.00">4096x1024</text>
</g>
<!-- hidden_state&#45;&gt;k_proj -->
<g id="edge2" class="edge">
<title>hidden_state&#45;&gt;k_proj</title>
<path fill="none" stroke="black" d="M135.04,-100C146.26,-100 158.06,-100 169.73,-100"/>
<polygon fill="black" stroke="black" points="169.93,-103.5 179.93,-100 169.93,-96.5 169.93,-103.5"/>
</g>
<!-- v_proj -->
<g id="node4" class="node">
<title>v_proj</title>
<polygon fill="#f0f0f0" stroke="black" points="344,-40 174,-40 174,-2 344,-2 344,-40"/>
<text text-anchor="middle" x="259" y="-24.8" font-family="Times,serif" font-size="14.00">Value Projection (Wv)</text>
<text text-anchor="middle" x="259" y="-9.8" font-family="Times,serif" font-size="14.00">4096x1024</text>
</g>
<!-- hidden_state&#45;&gt;v_proj -->
<g id="edge3" class="edge">
<title>hidden_state&#45;&gt;v_proj</title>
<path fill="none" stroke="black" d="M114.37,-80.88C141.04,-69.76 174.83,-55.67 202.93,-43.96"/>
<polygon fill="black" stroke="black" points="204.34,-47.16 212.22,-40.08 201.64,-40.7 204.34,-47.16"/>
</g>
<!-- q -->
<g id="node5" class="node">
<title>q</title>
<polygon fill="#f0f0f0" stroke="black" points="508,-175 401,-175 401,-137 508,-137 508,-175"/>
<text text-anchor="middle" x="454.5" y="-159.8" font-family="Times,serif" font-size="14.00">Query (Q)</text>
<text text-anchor="middle" x="454.5" y="-144.8" font-family="Times,serif" font-size="14.00">BxSx32x128</text>
</g>
<!-- q_proj&#45;&gt;q -->
<g id="edge4" class="edge">
<title>q_proj&#45;&gt;q</title>
<path fill="none" stroke="black" d="M347.13,-156C361.76,-156 376.68,-156 390.55,-156"/>
<polygon fill="black" stroke="black" points="390.92,-159.5 400.92,-156 390.92,-152.5 390.92,-159.5"/>
</g>
<!-- k -->
<g id="node6" class="node">
<title>k</title>
<polygon fill="#f0f0f0" stroke="black" points="508,-119 401,-119 401,-81 508,-81 508,-119"/>
<text text-anchor="middle" x="454.5" y="-103.8" font-family="Times,serif" font-size="14.00">Key (K)</text>
<text text-anchor="middle" x="454.5" y="-88.8" font-family="Times,serif" font-size="14.00">BxSx32x128</text>
</g>
<!-- k_proj&#45;&gt;k -->
<g id="edge5" class="edge">
<title>k_proj&#45;&gt;k</title>
<path fill="none" stroke="black" d="M338.15,-100C355.61,-100 373.9,-100 390.65,-100"/>
<polygon fill="black" stroke="black" points="390.86,-103.5 400.86,-100 390.86,-96.5 390.86,-103.5"/>
</g>
<!-- v -->
<g id="node7" class="node">
<title>v</title>
<polygon fill="#f0f0f0" stroke="black" points="683.5,-39 576.5,-39 576.5,-1 683.5,-1 683.5,-39"/>
<text text-anchor="middle" x="630" y="-23.8" font-family="Times,serif" font-size="14.00">Value (V)</text>
<text text-anchor="middle" x="630" y="-8.8" font-family="Times,serif" font-size="14.00">BxSx32x128</text>
</g>
<!-- v_proj&#45;&gt;v -->
<g id="edge6" class="edge">
<title>v_proj&#45;&gt;v</title>
<path fill="none" stroke="black" d="M344.02,-17.13C357.06,-16.66 370.39,-16.26 383,-16 446.54,-14.71 462.46,-14.77 526,-16 539.05,-16.25 553.02,-16.69 566.33,-17.18"/>
<polygon fill="black" stroke="black" points="566.22,-20.68 576.35,-17.56 566.49,-13.68 566.22,-20.68"/>
</g>
<!-- attn_scores -->
<g id="node9" class="node">
<title>attn_scores</title>
<polygon fill="#f0f0f0" stroke="black" points="698,-107 562,-107 562,-69 698,-69 698,-107"/>
<text text-anchor="middle" x="630" y="-91.8" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="630" y="-76.8" font-family="Times,serif" font-size="14.00">BxSxS</text>
</g>
<!-- q&#45;&gt;attn_scores -->
<g id="edge7" class="edge">
<title>q&#45;&gt;attn_scores</title>
<path fill="none" stroke="black" d="M504.29,-136.88C524.98,-128.77 549.26,-119.25 570.88,-110.78"/>
<polygon fill="black" stroke="black" points="572.24,-114 580.27,-107.1 569.69,-107.49 572.24,-114"/>
</g>
<!-- k&#45;&gt;attn_scores -->
<g id="edge8" class="edge">
<title>k&#45;&gt;attn_scores</title>
<path fill="none" stroke="black" d="M508.03,-96.37C521.8,-95.41 536.95,-94.37 551.73,-93.34"/>
<polygon fill="black" stroke="black" points="552.14,-96.82 561.88,-92.64 551.66,-89.84 552.14,-96.82"/>
</g>
<!-- weighted_values -->
<g id="node11" class="node">
<title>weighted_values</title>
<polygon fill="#f0f0f0" stroke="black" points="981,-66 846,-66 846,-28 981,-28 981,-66"/>
<text text-anchor="middle" x="913.5" y="-50.8" font-family="Times,serif" font-size="14.00">Weighted Values</text>
<text text-anchor="middle" x="913.5" y="-35.8" font-family="Times,serif" font-size="14.00">BxSx32x128</text>
</g>
<!-- v&#45;&gt;weighted_values -->
<g id="edge11" class="edge">
<title>v&#45;&gt;weighted_values</title>
<path fill="none" stroke="black" d="M683.62,-25.05C726.48,-29.16 787.59,-35.02 835.88,-39.65"/>
<polygon fill="black" stroke="black" points="835.69,-43.15 845.98,-40.62 836.36,-36.18 835.69,-43.15"/>
</g>
<!-- attn_bias -->
<g id="node8" class="node">
<title>attn_bias</title>
<polygon fill="#f0f0f0" stroke="black" points="526,-63 383,-63 383,-25 526,-25 526,-63"/>
<text text-anchor="middle" x="454.5" y="-47.8" font-family="Times,serif" font-size="14.00">Attention Bias (b)</text>
<text text-anchor="middle" x="454.5" y="-32.8" font-family="Times,serif" font-size="14.00">BxSxS</text>
</g>
<!-- attn_bias&#45;&gt;attn_scores -->
<g id="edge9" class="edge">
<title>attn_bias&#45;&gt;attn_scores</title>
<path fill="none" stroke="black" d="M526.07,-61.9C534.66,-64.07 543.47,-66.31 552.14,-68.51"/>
<polygon fill="black" stroke="black" points="551.3,-71.91 561.86,-70.97 553.03,-65.12 551.3,-71.91"/>
</g>
<!-- softmax -->
<g id="node10" class="node">
<title>softmax</title>
<polygon fill="#f0f0f0" stroke="black" points="810,-92 734,-92 734,-54 810,-54 810,-92"/>
<text text-anchor="middle" x="772" y="-76.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="772" y="-61.8" font-family="Times,serif" font-size="14.00">BxSxS</text>
</g>
<!-- attn_scores&#45;&gt;softmax -->
<g id="edge10" class="edge">
<title>attn_scores&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M698.13,-80.81C706.81,-79.88 715.56,-78.94 723.82,-78.05"/>
<polygon fill="black" stroke="black" points="724.43,-81.51 734,-76.96 723.68,-74.55 724.43,-81.51"/>
</g>
<!-- softmax&#45;&gt;weighted_values -->
<g id="edge12" class="edge">
<title>softmax&#45;&gt;weighted_values</title>
<path fill="none" stroke="black" d="M810.02,-66.1C818.14,-64.59 827.02,-62.93 836.06,-61.25"/>
<polygon fill="black" stroke="black" points="836.71,-64.69 845.9,-59.41 835.43,-57.8 836.71,-64.69"/>
</g>
<!-- up_proj -->
<g id="node12" class="node">
<title>up_proj</title>
<polygon fill="#ea80fc" stroke="black" points="1176,-94 1024,-94 1024,-56 1176,-56 1176,-94"/>
<text text-anchor="middle" x="1100" y="-78.8" font-family="Times,serif" font-size="14.00">Up Projection (Wu)</text>
<text text-anchor="middle" x="1100" y="-63.8" font-family="Times,serif" font-size="14.00">4096x14336</text>
</g>
<!-- weighted_values&#45;&gt;up_proj -->
<g id="edge13" class="edge">
<title>weighted_values&#45;&gt;up_proj</title>
<path fill="none" stroke="black" d="M981.11,-57.11C991.7,-58.72 1002.78,-60.4 1013.73,-62.06"/>
<polygon fill="black" stroke="black" points="1013.31,-65.54 1023.72,-63.58 1014.36,-58.62 1013.31,-65.54"/>
</g>
<!-- gate_proj -->
<g id="node13" class="node">
<title>gate_proj</title>
<polygon fill="#ea80fc" stroke="black" points="1183,-38 1017,-38 1017,0 1183,0 1183,-38"/>
<text text-anchor="middle" x="1100" y="-22.8" font-family="Times,serif" font-size="14.00">Gate Projection (Wg)</text>
<text text-anchor="middle" x="1100" y="-7.8" font-family="Times,serif" font-size="14.00">4096x14336</text>
</g>
<!-- weighted_values&#45;&gt;gate_proj -->
<g id="edge14" class="edge">
<title>weighted_values&#45;&gt;gate_proj</title>
<path fill="none" stroke="black" d="M981.11,-36.89C989.42,-35.63 998.03,-34.32 1006.64,-33.02"/>
<polygon fill="black" stroke="black" points="1007.37,-36.45 1016.73,-31.49 1006.32,-29.53 1007.37,-36.45"/>
</g>
<!-- silu -->
<g id="node14" class="node">
<title>silu</title>
<polygon fill="#f0f0f0" stroke="black" points="1347,-66 1219,-66 1219,-28 1347,-28 1347,-66"/>
<text text-anchor="middle" x="1283" y="-50.8" font-family="Times,serif" font-size="14.00">SiLU Activation</text>
<text text-anchor="middle" x="1283" y="-35.8" font-family="Times,serif" font-size="14.00">BxSx14336</text>
</g>
<!-- up_proj&#45;&gt;silu -->
<g id="edge15" class="edge">
<title>up_proj&#45;&gt;silu</title>
<path fill="none" stroke="black" d="M1176.19,-63.37C1186.93,-61.71 1197.98,-60 1208.69,-58.34"/>
<polygon fill="black" stroke="black" points="1209.48,-61.76 1218.83,-56.77 1208.41,-54.84 1209.48,-61.76"/>
</g>
<!-- gate_proj&#45;&gt;silu -->
<g id="edge16" class="edge">
<title>gate_proj&#45;&gt;silu</title>
<path fill="none" stroke="black" d="M1183.03,-31.69C1191.7,-33.03 1200.48,-34.39 1209.04,-35.71"/>
<polygon fill="black" stroke="black" points="1208.55,-39.18 1218.96,-37.25 1209.62,-32.26 1208.55,-39.18"/>
</g>
<!-- down_proj -->
<g id="node15" class="node">
<title>down_proj</title>
<polygon fill="#ea80fc" stroke="black" points="1556,-66 1383,-66 1383,-28 1556,-28 1556,-66"/>
<text text-anchor="middle" x="1469.5" y="-50.8" font-family="Times,serif" font-size="14.00">Down Projection (Wd)</text>
<text text-anchor="middle" x="1469.5" y="-35.8" font-family="Times,serif" font-size="14.00">14336x4096</text>
</g>
<!-- silu&#45;&gt;down_proj -->
<g id="edge17" class="edge">
<title>silu&#45;&gt;down_proj</title>
<path fill="none" stroke="black" d="M1347.24,-47C1355.48,-47 1364.08,-47 1372.71,-47"/>
<polygon fill="black" stroke="black" points="1372.84,-50.5 1382.84,-47 1372.84,-43.5 1372.84,-50.5"/>
</g>
<!-- output -->
<g id="node16" class="node">
<title>output</title>
<polygon fill="#f0f0f0" stroke="black" points="1681,-66 1592,-66 1592,-28 1681,-28 1681,-66"/>
<text text-anchor="middle" x="1636.5" y="-50.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1636.5" y="-35.8" font-family="Times,serif" font-size="14.00">BxSx4096</text>
</g>
<!-- down_proj&#45;&gt;output -->
<g id="edge18" class="edge">
<title>down_proj&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1556.38,-47C1564.97,-47 1573.51,-47 1581.63,-47"/>
<polygon fill="black" stroke="black" points="1581.66,-50.5 1591.66,-47 1581.66,-43.5 1581.66,-50.5"/>
</g>
</g>
</svg>
